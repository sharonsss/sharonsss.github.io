---
title: Java 程序打包之后，替换 jar 包内的文件
tags: Java
categories: Java 程序
index_img: img/jar.jpg
date: 2020-04-30 20:55:37
---

**Java 对我来说绝对是一窍不通，基本陌生。**

<!-- more -->

奈何公司的工程师小伙伴开发了一个 Java 程序，前端、后端、数据库都是他自己一个人一手搭建起来的，遇到任何问题也只有他才能解决。

这两天领导一句话，要求把程序里的 Logo 换掉，可是小伙伴的程序都是打包好的，jar 包里的文件，怎么样替换呢？

小伙伴也不知道，这种不能像拆口袋一样，直接拆包替换东西。

下载到本地，在压缩软件里，不解压的情况下直接替换里面的 logo 文件，再上传到服务器？

**尝试失败。**

文件在压缩包里替换成功，但上传到服务器，替换原 jar 包之后，运行程序会报错，显示修改打包文件错误。

看来不能直接这样替换文件？！

![wunai](/img/wunai.jpg)

之后，在万能百度上才找到正确方法：

## 替换 jar 包中指定文件

1. **找到 jar 包中指定文件的路径：**

先进入 jar 包所在的目录下：

```
jar -tvf test.jar | grep logo.svg
```

2. **解压指定路径下的文件**

```
jar -xvf test.jar conf/logo.svg
```

会自动在当前路径下创建目录。

3. **把需要替换的文件删除**

```
rm -rf conf/logo.svg
```

4. **上传文件到替换文件的目录下**

```terminal
$ scp 本地目录 服务器目录（绝对路径）
```

5. **更新到 jar 包中**

```
jar -uvf test.jar conf/logo.svg
```

<br>

## 2020.05.25 补充

实操过程中，正确替换了 Jar 包中的文件之后，需要重新启动服务器，然后重新启动 Redis、应用程序、Nginx，不然系统还是运行不起来的。mark 一下。

<br>

## 2020.06.09 补充

上面记录的太过简单，这里再补充一下当时复制 `jar` 包到本地时，需要注意的地方。

### 1. 从远程服务器下载文件到本地电脑

首先，将 **远程服务器(已登陆)** 的文件复制到本地，即将文件下载到 **本地电脑** ，需要使用 `scp` 命令。

如果是已经登陆了远程的服务器，相当于远程的服务器是“本地”，而需要下载到的电脑就变成了“远程”。因此，scp 命令中不需要加入远程服务器的用户名和 `IP`，相反，本机电脑的地址需要加上用户名和 `IP`：

```
scp 已经登陆的远程服务器的绝对路径 username@ip:本机电脑的绝对路径
```

第一次尝试的时候，出现了 **本地 ip** `connection failed` 的错误。网上搜索了半天答案，无解。

后来意识到，**莫非是电脑远程访问权限的问题？** 于是进到 `sharing` 里，打开了**远程登录**的权限。

再次尝试，出现如下提示：

```
The authenticity of host '10.xx.xx.xx' can't be established.
ECDSA key fingerprint is xxxxxx.
ECDSA key fingerprint is MD5:xxxxx.
Are you sure you want to continue connecting (yes/no)?
```

这里选择 `yes`，会出现一条 `warning` 信息，提示风险。如果是确定的操作，不用理会。

`Warning: Permanently added '10.xx.xx.xx' (ECDSA) to the list of known hosts.`

然后会要求输入电脑密码，回车，远程服务器上的文件就可以正常下载了。

### 2. 从本地电脑上传文件至远程服务器

与上面相反，如果要将本地电脑的文件上传到远程服务器，则需要使用命令：

```
scp username@ip:本机电脑的绝对路径 已经登陆的远程服务器的绝对路径
```

为了防止弄混，需要记住一点：

`scp` 命令中，第一个路径是 **输出路径**， 第二个路径是 **输入路径**。不管是从远程到本地还是本地到远程，**输入输出的路径顺序是不变的**。

另外， `scp` 命令前也不需要加 `sudo`。

---

**参考来源：**

- _[使用 jar 命令替换 jar 包中指定文件](https://blog.csdn.net/u011817217/article/details/92411009)_
